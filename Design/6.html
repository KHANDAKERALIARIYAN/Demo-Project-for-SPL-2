<!-- lending.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lending</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { display: flex; }
    #sidebar { width: 250px; background: #343a40; min-height: 100vh; }
    #sidebar .nav-link { color: #fff; }
    #sidebar .nav-link.active { background: #495057; }
    #content { flex-grow: 1; padding: 20px; }
  </style>
</head>
<body>
  <div id="sidebar" class="p-3">
    <h5 class="text-white">ARSAFA Solution</h5>
    <nav class="nav flex-column">
      <a class="nav-link" href="1.html">Dashboard</a>
      <a class="nav-link" href="2.html">Inventory</a>
      <a class="nav-link" href="3.html">Sales Report</a>
      <a class="nav-link" href="4.html">Invoices</a>
      <a class="nav-link" href="5.html">Customers</a>
      <a class="nav-link active" href="6.html">Lending</a>
    </nav>
  </div>
  <div id="content">
    <div class="container mt-4">
      <h3>Lending</h3>
      <input type="text" id="searchInput" class="form-control mb-3" placeholder="Search customer...">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Customer</th>
            <th>Amount</th>
            <th>Due Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="lendingTbody">
          <!-- Lending records will be rendered here -->
        </tbody>
      </table>
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#lendingModal">Add Lending</button>
    </div>
  </div>

  <!-- Add/Edit Lending Modal -->
  <div class="modal fade" id="lendingModal" tabindex="-1" aria-labelledby="lendingModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="lendingForm">
          <div class="modal-header">
            <h5 class="modal-title" id="lendingModalLabel">Add/Edit Lending</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editIndex">
            <div class="mb-3">
              <label class="form-label">Customer</label>
              <input type="text" class="form-control" id="lendingCustomer" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Amount</label>
              <input type="number" class="form-control" id="lendingAmount" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Due Date</label>
              <input type="date" class="form-control" id="lendingDueDate" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Status</label>
              <select class="form-select" id="lendingStatus" required>
                <option value="Unpaid">Unpaid</option>
                <option value="Paid">Paid</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    let lendings = [
      { customer: "Mark Lee", amount: 300, dueDate: "2025-06-15", status: "Unpaid" },
      { customer: "Jane Smith", amount: 150, dueDate: "2025-06-20", status: "Paid" }
    ];

    function renderLendings(filter = "") {
      const tbody = document.getElementById('lendingTbody');
      tbody.innerHTML = "";
      lendings.forEach((lend, idx) => {
        if (
          lend.customer.toLowerCase().includes(filter.toLowerCase()) ||
          lend.status.toLowerCase().includes(filter.toLowerCase())
        ) {
          tbody.innerHTML += `
            <tr>
              <td>${lend.customer}</td>
              <td>$${lend.amount}</td>
              <td>${lend.dueDate}</td>
              <td><span class="badge bg-${lend.status === "Paid" ? "success" : "danger"}">${lend.status}</span></td>
              <td>
                <button class="btn btn-sm btn-info" onclick="sendReminder('${lend.customer}')">Send Reminder</button>
                <button class="btn btn-sm btn-warning" onclick="editLending(${idx})">Edit</button>
                <button class="btn btn-sm btn-danger" onclick="deleteLending(${idx})">Delete</button>
              </td>
            </tr>
          `;
        }
      });
    }

    // Add/Edit Lending
    document.getElementById('lendingForm').onsubmit = function(e) {
      e.preventDefault();
      const customer = document.getElementById('lendingCustomer').value;
      const amount = document.getElementById('lendingAmount').value;
      const dueDate = document.getElementById('lendingDueDate').value;
      const status = document.getElementById('lendingStatus').value;
      const editIndex = document.getElementById('editIndex').value;

      if (editIndex === "") {
        lendings.push({ customer, amount, dueDate, status });
      } else {
        lendings[editIndex] = { customer, amount, dueDate, status };
      }
      renderLendings(document.getElementById('searchInput').value);
      bootstrap.Modal.getInstance(document.getElementById('lendingModal')).hide();
      this.reset();
      document.getElementById('editIndex').value = "";
      document.getElementById('lendingModalLabel').innerText = "Add/Edit Lending";
    };

    // Edit Lending
    window.editLending = function(idx) {
      const lend = lendings[idx];
      document.getElementById('lendingCustomer').value = lend.customer;
      document.getElementById('lendingAmount').value = lend.amount;
      document.getElementById('lendingDueDate').value = lend.dueDate;
      document.getElementById('lendingStatus').value = lend.status;
      document.getElementById('editIndex').value = idx;
      document.getElementById('lendingModalLabel').innerText = "Edit Lending";
      new bootstrap.Modal(document.getElementById('lendingModal')).show();
    };

    // Delete Lending
    window.deleteLending = function(idx) {
      if (confirm("Are you sure you want to delete this record?")) {
        lendings.splice(idx, 1);
        renderLendings(document.getElementById('searchInput').value);
      }
    };

    // Send Reminder
    window.sendReminder = function(customer) {
      alert("Reminder sent to " + customer + "!");
    };

    // Search Lending
    document.getElementById('searchInput').addEventListener('input', function() {
      renderLendings(this.value);
    });

    // Reset modal on close
    document.getElementById('lendingModal').addEventListener('hidden.bs.modal', function () {
      document.getElementById('lendingForm').reset();
      document.getElementById('editIndex').value = "";
      document.getElementById('lendingModalLabel').innerText = "Add/Edit Lending";
    });

    // Initial render
    renderLendings();
  </script>
</body>
</html>